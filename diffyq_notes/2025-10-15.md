---
id: "2025-10-15"
aliases: []
tags: []
---

# Solving Non-Homogenous Equations, with Constant Coefficents: Method of Undetermined Coefficents

$$ay'' + by' + cy = f(x)$$
$$y = y_h + y_p$$


## Example: 
$$y''+3y'-4y=e^{-x}$$

General Procedure: 
1. Solve for the homogenous equation
2. Solve for the particular solution

### Solving for homogenous equation

$$r^2 -3r -4 = 0$$
$$r_{1,2} = \dfrac{3 \pm \sqrt{9+16}}{2} \dfrac{3 \pm 5}{2} = 4,-1$$
$$\implies y_h = c_1 e^{4x} + c_2 e^{-x} $$
$$\text {trial solution } y_p = ae^{-x} \text{ note this is linearly dependent to to } c_1e^{-x}$$
$$\implies \text{ we must add a non-constant term to resolve the linear dependency } y_p = Axe^{-x}$$
$$y'_p = Ae^{-x} - Axe^{-x}$$
$$y'_p = -2Axe^{-x} + Axe^{-x}$$

Now we can subsitute into the differential equation $y''+3y'-4y=e^{-x}$, dropping $e^{-x} \neq 0$ we get: 

$$y = -2A + Ax -3(A-Ax) - 4Ax = 1$$

Merge the terms that contain x


$$y = x(A+3A-4A) + (-2A-3A) = 1$$
$$y = x(A-1A) + (-5A) = 1$$
Split into like terms:

$$0 = A-A$$
$$1 = -5A$$
$$\implies A = \dfrac{1}{5} \implies y_p = \dfrac{1}{5}xe^{-x}$$

Note: The trial solution must be different from the $y_h$

## Example: 

$$y''-2y'+y=e^{x}$$
### Solve Homo
$$r^2 - 2r + 1 = 0$$
$$(r-1)^2 = 0 \implies r_{1,2} = 1$$
$$y_h = c_1e^x + c_2 xe^x$$

In general we keep adding x until the funcitons are linearly indepdenent 
$$\implies y_p = Ax^2e^x$$

Now find all terms of $y_p, y_p', y_p''$
$$y_p = Ax^2e^x$$
$$y_p' = 2Ax^2e^x + Ax^2e^x$$
$$y_p'' = 2Ax^2e^x + 4Axe^x + Ax^2e^x$$

Subsitute into $y_p$, dropping $e^x = 0$ by dividing both sides of $y''-2y'+y=e^{x}$ by $e^x$
$$y_p = 2A + 4Ax +Ax^2 - 2(2Ax + Ax^2) + Ax^2 = 1 + 0x + 0x^2$$
$$0x^2 = A -2A + A$$
$$x0 = 4A -4A$$
$$1 = 2A$$
$$\implies A = \dfrac{1}{2} \implies y = [c_1e^x + c_2xe^x] + (\dfrac{1}{2}x^2e^x)$$

## Example 
$$y''+2y'-3y = f(x)$$

Want to determine form of $y_p$ aka find the trial solution where $f(x)$ is:
<!-- TODO:: How to come about finding a trial solution -->
1. Case 1 $x^2+x-3$
2. Case 2 $e^{-x}$
3. Case 4 $2xsin(3x)+cos(3x)$
4. Case 5 $xe^{-2x}sin(x)$

### Finding $y_h$
Solution: 

$$y_h = r^2 + 2r - 3 = 0$$
$$r_{1,2} = \dfrac{-2 \pm \sqrt{4+12}}{2} = \dfrac{-2 \pm 4}{2} = -1 \pm 2 = 1,-3$$
$$\implies y_h = c_1e^x + c_2e^{-3x}$$

### Finding $y_p$

#### Case 1
* $y_p = Ax^2 + Bx + C$
* $A,B,C$ correspond to combinations of $x^2, x, 1$
* Compare w/ $y_h = c_1e^x + c_2e^{-3x}$ and note if we need any $x$ term to resolve linear dependencies for $y_p$ and it's derivaties
#### Case 2
* $y_p = Ae^{-x}x^s$
* Compare w/ $y_h = c_1e^x + c_2e^{-3x}$ and note if we need any $x$ term to resolve linear dependencies, for $y_p$ and it's derivaties, in this case no, so $s=0$
#### Case 3
* $y_p = Axe^{x}x^s$
Compute it's derivaties
* $y_p = Axe^{x}$
* $y_p' = Axe^{x} + Ae^x$
Thus the correct trial solution is: 
    * $y_p = (Ax+B)e^x \cdot x^s$
* Compare w/ $y_h = c_1e^x + c_2e^{-3x}$ and note if we need any $x$ term to resolve linear dependencies, for $y_p$ and it's derivaties
    * Observe $Be^x$ is linearly dependent $c_1e^x$
#### Case 3
* Note: we could solve this by superposition
    * $f_1(x) = 2xsin(3x) \implies y_{p1} = y_p \land f_2(x) = cos(3x) \implies y_{p2} = Ecos(3x) + Fsin(3x)$
* $2xsin(3x)+cos(3x)$
* $y_p = (Ax + B)sin(3x)  + (Cx + D)cos(3x)$
* Check for linear dependency, note all roots are real so $s=0$
* $y_p = [(Ax + B)sin(3x)  + (Cx + D)cos(3x)]x^s$

#### Case 5
* $xe^{-2x}sin(x)$
* $y_p = e^{-2x}[(Ax+B)sin(x) + (Cx+D)cos(x)]x^s$

